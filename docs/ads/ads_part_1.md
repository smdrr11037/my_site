# é«˜çº§æ•°æ®ä¸ç®—æ³•åˆ†æâ€”â€”Part 1
## Preparation Before Class
------
* æ•™æ
  
      æ•°æ®ç»“æ„æ•™æ

      **introduction to algorithms**

      algorithm design

      æ•°æ®ç»“æ„å­¦ä¹ ä¸å®éªŒæŒ‡å¯¼

* è¯„åˆ†
    
    ä½œä¸šï¼š10%

    Discussionï¼š10%

    Research Topicï¼š10%
    
    æœŸä¸­ï¼š10%ï¼ˆå¯è¢«æœŸæœ«è¦†ç›–ï¼‰

    æœŸæœ«ï¼š40%

## AVL Trees
------
* ç›®æ ‡ï¼šåŠ é€ŸæŸ¥æ‰¾

* æ–¹æ³•ï¼šæŸ¥æ‰¾æ ‘
    
    * O(height)
    
    * é€’å¢/é€’å‡åºåˆ—é€€åŒ–æˆé“¾
    
    * æœ€å¥½æƒ…å†µï¼ˆæ ‘æœ€çŸ®ï¼‰ï¼šæ‰€æœ‰å­æ ‘é«˜åº¦ç›¸ç­‰â€”â€”å¤ªè‹›åˆ»

----
### AVLæ ‘å®šä¹‰
  * ç©ºæ ‘å¹³è¡¡
  

  * éç©ºæ ‘å¹³è¡¡å½“ä¸”ä»…å½“
   
    * å·¦å­æ ‘ä¸å³å­æ ‘éƒ½å¹³è¡¡
    
    * å·¦å³å­æ ‘é«˜åº¦å·®å°äºç­‰äº1
  

  * å¹³è¡¡å› å­BFï¼ˆnodeï¼‰=å·¦å­æ ‘é«˜åº¦-å³å­æ ‘é«˜åº¦
    
    * AVLåªèƒ½å–-1ï¼Œ0ï¼Œ1

> æœ¬è¯¾ä¸­å®šä¹‰ç©ºæ ‘é«˜åº¦ä¸º-1
<!--  -->

> å‡ ä¸ªä¾‹å­ï¼š
> ![alt text](image-14.png)
> 


è¿™æ ·å°±å¾—åˆ°äº†æ€§è´¨è¾ƒå¥½çš„æ ‘

----
### å¦‚ä½•å¾—åˆ°AVLæ ‘
* **æ ‘çš„æ—‹è½¬**
![alt text](image-15.png)
Bé«˜åº¦å¢åŠ 1ï¼ŒAé«˜åº¦å‡å°‘1ã€‚å¤æ‚åº¦ä¸º$O(1)$ï¼Œä»£ç å¦‚ä¸‹
```c
typedef struct Node *Tree;
struct Node
{
    ElementType Element;
    Tree Left;
    Tree Right;
}

A->Left=B->Right;
B->Right=A;
return B;//æ–°æ ¹
```

**AVLæ ‘çš„æ’å…¥**ï¼š
   
   æ¯æ’å…¥ä¸€ä¸ªæ–°ç»“ç‚¹ï¼Œè®°å½•ï¼ˆä»¥å…¶ä¸ºæ ¹èŠ‚ç‚¹çš„ï¼‰é«˜åº¦ï¼Œä»ä¸‹åˆ°ä¸Šæ›´æ–°çˆ¶èŠ‚ç‚¹é«˜åº¦ï¼Œè®¡ç®—å¹³è¡¡å› å­ï¼Œä¸€ä½†ä¸ç¬¦åˆæ¡ä»¶
   
* å› å­åœ¨åŒä¸€ä¸ªæ–¹å‘å˜åŒ–
    
    -2ï¼šå·¦æ—‹ï¼ˆRR Rotationâ€”â€”æŒ‡ä»å¤±è¡¡èŠ‚ç‚¹å¼€å§‹å‘å³æ’ä¸¤æ¬¡çš„æƒ…å†µï¼‰
    
    2ï¼š å³æ—‹ï¼ˆLL Rotationï¼Œä¸RRå¯¹ç§°ï¼‰
![alt text](image-16.png)

* ä¸åŒæ–¹å‘ï¼šæŠŠæ ‘é«˜é«˜æ–¹å‘çš„å­™å­è½¬ä¸Šæ¥ï¼Œè½¬ä¸¤æ¬¡ï¼ˆä¸¤ç§å¯¹ç§°æƒ…å†µï¼ŒLRå’ŒRLï¼‰
![alt text](image-6.png)

å®é™…ä¸Šï¼Œæ ¹æ®AVLæ ‘çš„è‰¯å¥½å®šä¹‰ï¼Œåœ¨æ¯æ¬¡æ’å…¥ååªéœ€è¦ä¸€æ¬¡æ“ä½œï¼ˆRR/LR...ï¼‰å°±èƒ½ä½¿å…¶å†æ¬¡å¹³è¡¡ã€‚

**AVLæ ‘çš„åˆ é™¤**ï¼š

ç”¨åˆ é™¤èŠ‚ç‚¹å·¦å­æ ‘çš„æœ€å¤§èŠ‚ç‚¹/å³å­æ ‘çš„æœ€å°èŠ‚ç‚¹æ›¿æ¢ä»–ï¼ˆä¸BSTç›¸åŒï¼‰ï¼Œå†åˆ é™¤ã€‚

ä»åˆ é™¤èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹å¼€å§‹ï¼ˆæ›¿æ¢åï¼‰ï¼Œè®°å½•ï¼ˆä»¥å…¶ä¸ºæ ¹èŠ‚ç‚¹çš„ï¼‰é«˜åº¦ï¼Œä»ä¸‹åˆ°ä¸Šæ›´æ–°çˆ¶èŠ‚ç‚¹é«˜åº¦ï¼Œè®¡ç®—å¹³è¡¡å› å­ï¼Œä¸€ä½†ä¸ç¬¦åˆæ¡ä»¶ï¼Œå°±ç”¨insertä¸­çš„æ–¹æ³•è°ƒæ•´ã€‚åœ¨åˆ é™¤æ“ä½œä¸­ï¼Œå¯èƒ½ä¼šéœ€è¦å¤šæ¬¡è°ƒæ•´ã€‚


----
### å¤æ‚åº¦åˆ†æ
  æ ‘é«˜çš„æ¸è¿›ä¸Šç•Œ

  $n_h$â€”â€”hé«˜åº¦çš„æ ‘éœ€è¦çš„æœ€å°ç»“ç‚¹æ•°

  é«˜åº¦ä¸ºhçš„æ ‘ï¼ˆæ‰€éœ€èŠ‚ç‚¹æœ€å°‘ï¼‰å¦‚ä¸‹
![alt text](image-7.png)

  > ä¸æ–æ³¢é‚£å¥‘æ•°åˆ—ç±»ä¼¼ï¼š
  >
  > $F_0=0,F_1=1,F_n=F_{n-1}+F_{n-2}$
  >
  > è€Œ$F_n\approx\frac{1}{\sqrt{5}}(\frac{1+\sqrt{5}}{2})^i$
  
  æ‰€ä»¥  $n_h =F_{n+3}-1$
  
  * $h=O(lnn)$
## Splay Trees
------
* ç›®æ ‡ï¼šMæ¬¡æ“ä½œï¼Œæ€»çš„æ—¶é—´å¤æ‚åº¦$O(MlogN)$ï¼Œå³æ¯ä¸ªæ“ä½œå¹³å‡å¤æ‚åº¦ä¸º$O(logN)$

* åŸºæœ¬æ€æƒ³ï¼šæ¯æ¬¡æŸ¥è¯¢/æ’å…¥ï¼Œå°†è¯¥å…ƒç´ æåˆ°æ ¹èŠ‚ç‚¹

### æ„é€ è¿‡ç¨‹
  
  * å¦‚æœæŸ¥è¯¢èŠ‚ç‚¹çš„çˆ¶äº²æ˜¯æ ¹â€”â€”æ—‹è½¬æŸ¥è¯¢èŠ‚ç‚¹
 
  * å¦‚æœä¸æ˜¯ï¼Œåˆ™æœ‰çˆ¶äº²èŠ‚ç‚¹ï¼ˆPï¼‰å’Œç¥–çˆ¶èŠ‚ç‚¹ï¼ˆGï¼‰
    * zig-zagï¼ˆzå­—å½¢ï¼‰ï¼šè½¬ä¸¤æ¬¡å½“å‰èŠ‚ç‚¹
    * zig-zigï¼ˆä¸€ä¸ªæ–¹å‘ï¼‰ï¼šå…ˆè½¬çˆ¶èŠ‚ç‚¹ï¼Œå†è½¬å½“å‰èŠ‚ç‚¹
![alt text](image-8.png)

### åˆ é™¤æ“ä½œ
  1. æ‰¾åˆ°è¦åˆ é™¤çš„å…ƒç´ Xï¼ˆè¿™æ ·è®©å…¶åœ¨æ ¹èŠ‚ç‚¹ï¼‰
  
  2. åˆ æ‰Xï¼Œå¾—åˆ°å·¦å­æ ‘å’Œå³å­æ ‘
  
  3. æ‰¾åˆ°å·¦å­æ ‘æœ€å¤§çš„èŠ‚ç‚¹ï¼Œå°†å…¶æ¨åˆ°æ ¹èŠ‚ç‚¹
  
  4. è¿™æ ·å°±èƒ½ç›´æ¥å°†å³å­æ ‘æ¥åˆ°å·¦å­æ ‘çš„å³è¾¹

## Amortized Analysis(Three normal methods)
------
> An amortized analysis guarantees the average performance of
each operation in the worst case.

* Splayæ ‘çš„ç›®æ ‡ï¼šMæ¬¡æ“ä½œï¼Œæ€»çš„æ—¶é—´å¤æ‚åº¦$O(MlogN)$â€”â€”å‡æ‘Šæ—¶é—´ä¸Šç•Œ(**Amortized time bound**)

* worst-case bound >= amortized time bound >= average-case bound

* å‰ä¸¤ç§ä¸æ•°æ®åˆ†å¸ƒæ— å…³

### æ ˆçš„ä¾‹å­ä»¥åŠæ–¹æ³•è¯´æ˜

#### èšåˆåˆ†æ
  å¯¹äºæ‰€æœ‰ nï¼Œn ä¸ªè¿ç®—åºåˆ—æ€»å…±éœ€è¦æœ€åæƒ…å†µæ—¶é—´ï¼ˆdetermine an upper boundï¼‰ Tï¼ˆnï¼‰ã€‚å› æ­¤ï¼Œåœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œæ¯æ¬¡æ“ä½œçš„å¹³å‡æˆæœ¬æˆ–æ‘Šé”€æˆæœ¬ä¸º Tï¼ˆnï¼‰/nã€‚
  
> ä»¥æ ˆä¸ºä¾‹ï¼š

  * pushï¼š$O(1)$ï¼Œ popï¼š$O(1)$ï¼Œ 
  
  * multipopï¼ˆä¸€æ¬¡popå‡ºnä¸ªï¼‰ï¼š$min\{kï¼Œn\}=O(n)$ï¼Œå…¶ä¸­kæ˜¯å½“å‰æ ˆä¸­å…ƒç´ æ•°
  
  * æ‰€ä»¥næ¬¡æ“ä½œä¸Šç•Œï¼š$O(n^2)$
  
  
  * æ›´ç²¾ç¡®ï¼šæ ˆä¸­å…ƒç´ æ•°è‚¯å®šå°äºnï¼Œpushè¿›çš„å…ƒç´ åªèƒ½popä¸€æ¬¡ï¼Œæ‰€ä»¥æ€»çš„æ—¶é—´å¤æ‚åº¦$O(n)$
  $$T_{amortized}= O( n )/n = O(1)
  $$

------
#### æ ¸ç®—æ³•
> ä»¥å–æ±½æ°´ä¸ºä¾‹ï¼š

* aå–ä¸€ç“¶æ±½æ°´**3å…ƒ**

* bç”¨**5å…ƒ**ä¹°æ±½æ°´ï¼Œå­˜ä¸¤å…ƒï¼ˆcreditsï¼‰åˆ°aé‚£ï¼Œä¸‹æ¬¡ä¹°æ±½æ°´å¯ä»¥ç”¨ã€‚æ­¤æ—¶actual costï¼š3å…ƒ

* $amortized\ cost = actual\ cost + credits$

* ä¹°nç“¶æ±½æ°´ï¼Œboundï¼š
$$
amortized\ cost \geq  actual\ cost(å³3nå…ƒï¼Œå› ä¸ºä¸èµŠè´¦)
$$

**æ³¨æ„ä¿è¯æœ€ç»ˆä¿¡ç”¨ä¸å°äº0**

å›åˆ°æ ˆæ“ä½œï¼š

* å®é™…ä»£ä»·ï¼špush=1, pop=1, multipop=min(sizeof(s),k)

* å‡æ‘Šä»£ä»·ï¼špush = 2(æå‰æŠŠpopçš„ä»£ä»·ä»˜æ‰ï¼Œå³ä½¿ä¸popè¯¥å…ƒç´ ), pop = multipop = 0ï¼Œè¿™æ ·æ‰€æœ‰ä»£ä»·éƒ½æ˜¯å¸¸æ•°

* Creditsï¼špush = +1, pop = -1, multipop = -min(sizeof(s),k)

* multipopæ—¶çš„ä¿¡ç”¨ä¸ºsizeof(s)ï¼Œå› æ­¤ä¸ä¼šå‡ºç°ä¿¡ç”¨ä¸ºè´Ÿçš„æƒ…å†µ

* næ¬¡æ“ä½œæœ€å¤§çš„amortized costä¸º2nï¼Œ$T_{amortized}= O( n )/n = O(1)$

------
#### åŠ¿èƒ½æ³•

* $\Phi(D_i)$ï¼šåŠ¿èƒ½å‡½æ•°ï¼Œè¡¨ç¤º$D_i$çŠ¶æ€çš„åŠ¿èƒ½

* $Credits =\Phi(D_i)-\Phi(D_{i-1})$; 
    * å½“ Credits > 0 æ—¶ï¼ŒåŠ¿èƒ½å¢åŠ ï¼Œç›¸å½“äºæŠŠæå‰æ”¯ä»˜çš„ä»£ä»·å­˜å‚¨ä¸ºåŠ¿èƒ½
    * å½“ Credits < 0 æ—¶ï¼ŒåŠ¿èƒ½å‡å°‘ï¼Œç›¸å½“äºæŠŠæå‰æ”¯ä»˜çš„ä»£ä»·ç”¨æ‰

* è¿™æ ·æˆ‘ä»¬å°±èƒ½ç®—å‡ºå‡æ‘Šä»£ä»·($\hat{c_i}$ æ˜¯å‡æ‘Šä»£ä»·ï¼Œ $c_i$ æ˜¯å®é™…ä»£ä»·)
  $$
  \hat c_i = c_i+\Phi(D_i)-\Phi(D_{i-1})
  $$

* åˆæ³•çš„åŠ¿èƒ½å‡½æ•°ï¼šä¿è¯$\Phi(D_{0})$æ˜¯æœ€å°çš„ï¼Œè¿™æ ·æ€»çš„Credits$=\Phi(D_n)-\Phi(D_{0})$>0ï¼Œä½¿å¾—å‡æ‘Šä»£ä»·æ˜¯å®é™…ä»£ä»·çš„ä¸Šç•Œã€‚
$$
\sum_{i=1}^n\hat{c_i}=\sum_{i=1}^n(c_i+\Phi(D_i)-\Phi(D_{i-1}))=\sum_{i=1}^nc_i+\Phi(D_n)-\Phi(D_{0})
$$


å†æ¬¡å›åˆ°æ ˆ

* åŠ¿èƒ½å‡½æ•°$\Phi(D_i)=D_i$æ—¶åˆ»æ ˆä¸­çš„å…ƒç´ æ•°

* è®¡ç®—å‡æ‘Šä»£ä»·ï¼š

  * pushï¼š$\hat{c_i}=c_i+\Phi(D_i)-\Phi(D_{i-1})=1+1=2$

  * multipopï¼š$\hat{c_i}=c_i+\Phi(D_i)-\Phi(D_{i-1})=k'-k'=0$

* æ¯ä¸ªæ“ä½œçš„ä»£ä»·éƒ½æ˜¯O(1)â€”â€”å‡æ‘Šä»£ä»·æ˜¯O(1)

-----
### Spalyæ ‘å‡æ‘Šåˆ†æ

åº”ç”¨ï¼šåˆ†æsplay treeçš„å‡æ‘Šä»£ä»·â€”â€”Amortized Analysis Using Potential Methods:

> æ ‘çš„å¸¸è§åŠ¿èƒ½å‡½æ•°ï¼šèŠ‚ç‚¹ä¸ªæ•°ã€æ ‘é«˜Â·Â·Â·

(å› ä¸ºæŠ¥å‘Šç”¨è‹±æ–‡å†™çš„æ‰€ä»¥ä¸‹é¢æ˜¯è‹±æ–‡)

In tree's amortized analysis, we often use the height of tree or the amount of nodes as the potential function, which satisfy $\Phi(0)$ is the minimum. To make the potential function increasing slowly, we choose $\Phi(T)=log{\sum_{i\in T}S(i)}$, where S(i) is the number of descendants of i (i included). $\Phi(T)$ is also called rank of T, notion $R(T)$

> Lemma: If $a+b\leq c$ 
>
> then  $loga+logb\leq 2logc-2$

Same as the part of algorithm analysis, there are three situations to discuss according to the picture.
  
* If the "X" to be pushed is one of the childs of root, we only need one rotation. Except X and P, the "S(i)"  didn't change, and the rotation cost $c_i$ is 1. So the amortized cost 
  $$
  \hat{c_i}=1+R_2(X)-R_1(X)+R_2(P)-R_1(P)
  $$
  $$
  \leq 1+R_2(X)-R_1(X)
  $$
    (shown below that $R_2(P)<R_1(P)$)
   ![alt teXt](image-11.png)
  
* In the zig-zag case, we need two rotation, costing 2. We note that $R_2(X) = R_1(G) = log(the\ number\ of\ nodes\ in\ T)$. So the amortized cost 
  $$
  \hat{c_i}=2+R_2(X)-R_1(X)+R_2(P)-R_1(P)+R_2(G)-R_1(G)
  $$

  $$
  =2-R_1(X)+R_2(P)-R_1(P)+R_2(G)
  $$

  $$
  \leq 2(R_2(X)-R_1(X))
  $$
    (shown below that nodes: $P_2+G_2<X_2,\ so\ according\ to\ lemma,\ R_2(P)+R_2(G)\leq 2R_2(X)+2$)
    ![alt teXt](image-9.png)
* In the zig-zig case, we need two rotation, too, costing 2. We also note that $R_2(X) = R_1(G)$. So the amortized cost 
  $$
  \hat{c_i}=2+R_2(X)-R_1(X)+R_2(P)-R_1(P)+R_2(G)-R_1(G)
  $$

  $$
  =2-R_1(X)+R_2(P)-R_1(P)+R_2(G)
  $$
   $$
   =2-2R_1(X)+R_2(P)-R_1(P)+R_2(G)+R_1(X)
   $$
  $$
  \leq 3(R_2(X)-R_1(X))
  $$
    (shown below that nodes: $X_1+G_2<X_2,\ so\ according\ to\ lemma,\ R_1(X)+R_2(G)\leq 2R_2(X)+2$)
  ![alt teXt](image-10.png)

When splay, the former $3R_2(X)$ could be eliminated by the latter item's $-3R_1(X)$. After sum of all the items, we get:
$$
\hat{c_i} \leq 1+3(R_2(X)-R_1(X))=O(logN)
$$

------
### Incrementing a binary counter
> ç®—æ³•å¯¼è®ºçš„æ‘Šè¿˜åˆ†æä¾‹å­

Incrementing a binary counter(k bit in total)

* æ¯æ¬¡ä»ä½ä½å¾€é«˜ä½ç¿»è½¬bitï¼Œé‡åˆ°1ç»§ç»­ç¿»è½¬ï¼Œé‡åˆ°0ç¿»è½¬å®Œååœä¸‹æ¥

* worst case: æ¯æ¬¡æœ€å¤šè½¬kä¸ªbitsâ€”â€”011...1=>100...0

**èšåˆåˆ†æï¼š**

* A[0]æ¯æ¬¡éƒ½æ”¹å˜

* A[1]æ¯ä¸¤æ¬¡æ”¹å˜ä¸€æ¬¡

* å‡è®¾è®¡æ•°næ¬¡ï¼Œåˆ™A[0]æ”¹å˜$n$æ¬¡ï¼ŒA[1]æ”¹å˜$\lfloor\frac{n}{2}\rfloor$æ¬¡...A[i]æ”¹å˜$\lfloor\frac{n}{2^i}\rfloor$æ¬¡

* å› æ­¤æ€»å…±çš„æ“ä½œï¼ˆç¿»è½¬bitï¼‰çš„æ¬¡æ•°ä¸º

$$
\sum^{k-1}_{i=0}\lfloor\frac{n}{2^i}\rfloor<n\sum^{\infty}_{i=0}\frac{1}{2^i}=2n
$$

å› æ­¤æ€»çš„æ—¶é—´å¤æ‚åº¦ä¸Šç•Œä¸ºO(n)ï¼Œå‡æ‘Šæ—¶é—´å¤æ‚åº¦ä¸ºO(n)/n=O(1).

**æ ¸ç®—æ³•ï¼š**

* å®é™…ä»£ä»·ï¼š1å˜ä¸º0 = 1, 0å˜ä¸º1 = 1

* å‡æ‘Šä»£ä»·ï¼š0å˜ä¸º1 = 2(æå‰æŠŠ1å˜ä¸º0çš„ä»£ä»·ä»˜æ‰), 1å˜ä¸º0 = 0

* ä»0å¼€å§‹è®¡æ•°ï¼Œè‚¯å®šå…ˆå°†0å˜ä¸º1æ‰èƒ½å˜å›å»ï¼Œå› æ­¤ä¸ä¼šå‡ºç°ä¿¡ç”¨ä¸ºè´Ÿçš„æƒ…å†µ

* æˆ‘ä»¬çŸ¥é“æ¯æ¬¡æœ€å¤šåªæœ‰ä¸€ä¸ª0å˜æˆ1

* å› æ­¤å‡æ‘Šä»£ä»·ä¸ºO(1)

**åŠ¿èƒ½æ³•ï¼š**

* é€‰å–åŠ¿èƒ½å‡½æ•°ï¼šç¬¬ i æ¬¡æ“ä½œå 1 çš„æ•°ç›®ï¼Œè®°ä¸º $b_i$

* æ¯æ¬¡ç¿»è½¬ï¼Œå°†ä½ä½çš„è¿ç»­çš„ 1 ç¿»è½¬ä¸º 0 ï¼Œé‡åˆ°çš„ç¬¬ä¸€ä¸ª 0 ç¿»è½¬ä¸º 1 ã€‚å°†ç¿»è½¬1çš„æ•°ç›®è®¡ä¸º $t_i$ ï¼Œè¿™æ ·ä¸€æ¬¡æ“ä½œçš„å®é™…ä»£ä»· $c_i = t_i +1$

* åˆ†æƒ…å†µè®¨è®º $b_i$ å’Œ $b_{i-1}$ çš„å…³ç³»ï¼Œè¿™æ ·åœ¨ $\Phi(D_i)-\Phi(D_{i-1})$ ä¸­æ¶ˆå» $b_i$
    * $b_i=0$ â€”â€” åˆ™ç¬¬ i æ¬¡æ“ä½œå°† k ä¸ª 1 å…¨éƒ¨ç¿»è½¬ä¸º 0 ï¼Œæ‰€ä»¥ $b_{i-1}=k=t_i$
    * $b_i>0$ â€”â€” ç”¨ $b_{i-1}$ å’Œ $t_i$ è®¡ç®— $b_i$ ï¼š$b_i=b_{i-1}-t_i+1$
    * å› æ­¤ï¼Œ$b_i\leq b_{i-1}-t_i+1$


* ç°åœ¨æ¥è®¡ç®—å‡æ‘Šä»£ä»·
    $$
    \hat c_i = c_i+\Phi(D_i)-\Phi(D_{i-1}) = t_i +1 + b_i - b_{i-1}
    $$
    $$
    \leq t_i +1 + b_{i-1}-t_i+1- b_{i-1} = 2
    $$

* å› æ­¤æ¯æ¬¡æ“ä½œçš„å‡æ‘Šä»£ä»·éƒ½æ˜¯ $O(1)$

å½“ä¸ä» 0 å¼€å§‹è®¡æ•°æ—¶ï¼Œå³ $\Phi({D_0})\ne 0$ æ—¶ï¼Œè™½ç„¶æ— æ³•ä¿è¯ $\Phi(D_i)-\Phi(D_{i-1})\geq 0$ï¼Œä½†å‡æ‘Šä»£ä»·ä»æ˜¯ $O(1)$

å‰é¢æˆ‘ä»¬çŸ¥é“
$$
\sum_{i=1}^n\hat{c_i}=\sum_{i=1}^n(c_i+\Phi(D_i)-\Phi(D_{i-1}))=\sum_{i=1}^nc_i+\Phi(D_n)-\Phi(D_{0})
$$
è½¬æ¢ä¸€ä¸‹
$$
\sum_{i=1}^n{c_i}=\sum_{i=1}^n\hat c_i-\Phi(D_n)+\Phi(D_{0})=\sum_{i=1}^n\hat c_i-b_n+b_0 \leq \sum_{i=1}^n\hat c_i-k
$$
ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬ä¹‹é—´ç›¸å·®ä¸€ä¸ªå¸¸æ•° k ï¼Œè€Œè¿™å¯¹å‡æ‘Šä»£ä»·æ˜¯æ²¡æœ‰å½±å“çš„ï¼Œä»æ˜¯ $O(1)$

<!-- åé¢è¿˜æœ‰ä¸€èŠ‚å’Œä¹ é¢˜ç­‰ç­‰ -->

## Red-black Tree
------
> tips: è®¿é—®ç©ºæŒ‡é’ˆä¼š Sigementation faultï¼Œï¼Œå¯ä»¥æŒ‡å‘ä¸€ä¸ªè™šæ‹ŸèŠ‚ç‚¹ï¼ˆå“¨å…µï¼‰

* ç›®æ ‡ï¼šæ¯æ¬¡æœç´¢éƒ½$(logn)$

### 1. çº¢é»‘æ ‘å®šä¹‰
1. çº¢é»‘æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹è¦ä¹ˆæ˜¯çº¢è‰²çš„ï¼Œè¦ä¹ˆæ˜¯é»‘è‰²çš„

2. æ ¹èŠ‚ç‚¹æ˜¯é»‘è‰²çš„

3. æ¯ä¸ªå¶å­éƒ½æ˜¯å“¨å…µï¼ˆNILï¼‰ï¼Œå“¨å…µæ˜¯é»‘è‰²çš„

4. å¦‚æœèŠ‚ç‚¹æ˜¯çº¢è‰²çš„ï¼Œé‚£ä¹ˆä»–çš„å­©å­éƒ½æ˜¯é»‘è‰²çš„

5. æ¯ä¸ªèŠ‚ç‚¹åˆ°ï¼ˆèƒ½åˆ°è¾¾çš„ï¼‰æ‰€æœ‰å¶å­çš„ç®€å•è·¯å¾„ï¼Œç»è¿‡çš„é»‘è‰²èŠ‚ç‚¹æ•°ç›¸åŒ

--------

* black height: ä¸ç®—è‡ªå·±ã€ä¸ç®—å“¨å…µï¼Œä»è‡ªå·±åˆ°å¶å­ç»è¿‡çš„é»‘è‰²èŠ‚ç‚¹æ•°

> å¼•ç†ï¼šæœ‰ N ä¸ªå†…éƒ¨èŠ‚ç‚¹çš„çº¢é»‘æ ‘çš„é«˜ä¸è¶…è¿‡ 2ln(N+1)

è¯æ˜ï¼š

------
### 2. çº¢é»‘æ ‘æ„é€ 
 
 æ„é€ æƒ³æ³•ï¼šæ’å…¥æ–°èŠ‚ç‚¹ä¸”æŸ“æˆçº¢è‰²â€”â€”ä¿æŒæ€§è´¨5ï¼Œé€šè¿‡è¿­ä»£å˜æ¢ä¿æŒå…¶ä»–æ€§è´¨


**Insert**(ä¸æ»¡è¶³æ€§è´¨æœ‰ä¸‰ç§æƒ…å†µ)ï¼š
  
  * case 1ï¼šçº¢å”å”ï¼ˆæ‰€ä»¥çˆ·çˆ·è‚¯å®šé»‘è‰²ï¼‰â€”â€”å°†çˆ¸çˆ¸å’Œå”å”æŸ“é»‘ï¼Œçˆ·çˆ·æŸ“çº¢![alt text](image-12.png)
  
  * case 2ï¼šè¿‘å”å”é»‘â€”â€”æ—‹è½¬åˆ°case3
  
  * case 3ï¼šè¿œå”å”é»‘â€”â€”çˆ¶äº²æŸ“é»‘ï¼Œæ—‹è½¬çˆ·çˆ·![alt text](image-13.png)
  
è¿™æ ·ä¿æŒäº†æ¯æ¬¡åªæœ‰ä¸€æ¡è§„åˆ™è¢«ç ´å

* å¤æ‚åº¦ï¼šæœ€åæƒ…å†µâ€”â€”ä¸€ç›´case 1
$$
T = O(h) = O(logn)
$$

----
**Delete**

* è¢«åˆ èŠ‚ç‚¹æ˜¯leaf node: çˆ¶äº²æŒ‡å‘NIL

* åªæœ‰ä¸€ä¸ªå„¿å­ï¼šç”¨å„¿å­æ›¿ä»£ä»–

* æœ‰ä¸¤ä¸ªå„¿å­ï¼šç”¨å·¦å­æ ‘æœ€å¤§çš„/å³å­æ ‘æœ€å°çš„æ›¿ä»£ä»–ï¼ˆä¿æŒæœ¬èº«çš„é¢œè‰²ä¸å˜ï¼Œæ›¿æ¢å€¼ï¼‰ï¼Œå†é€’å½’åœ°åˆ é™¤æ›¿æ¢çš„èŠ‚ç‚¹

* å¦‚æœåˆ é™¤çš„èŠ‚ç‚¹ï¼ˆxï¼‰æ˜¯çº¢è‰²èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå®ƒä¸ä¼šå½±å“çº¢é»‘æ ‘çš„æ€§è´¨ï¼Œå¯ä»¥ç›´æ¥åˆ é™¤ã€‚åˆ é™¤é»‘è‰²èŠ‚ç‚¹å¯èƒ½ä¼šç ´åçº¢é»‘æ ‘çš„æ€§è´¨ï¼Œå› æ­¤éœ€è¦è¿›è¡Œä¿®æ­£ã€‚åˆ é™¤é»‘è‰²èŠ‚ç‚¹æ—¶ä¼šæœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µéœ€è¦è€ƒè™‘ï¼š

    * case 1ï¼šè¢«åˆ é™¤èŠ‚ç‚¹çš„å…„å¼ŸèŠ‚ç‚¹æ˜¯çº¢è‰²çš„ï¼Œè½¬æ¢æˆåé¢çš„å‡ ç§æƒ…å†µâ€”â€”å…ˆæŠŠå…„å¼ŸèŠ‚ç‚¹çš„çº¢è‰²ç»™çˆ¶äº²ï¼Œå†å°†å…„å¼ŸèŠ‚ç‚¹æ—‹è½¬ä¸Šå»
        ![alt text](image-60.png)

    * case 2ï¼šè¢«åˆ é™¤èŠ‚ç‚¹çš„å…„å¼ŸèŠ‚ç‚¹æ˜¯é»‘è‰²çš„ï¼Œä¸”å„¿å­éƒ½æ˜¯é»‘è‰²çš„â€”â€”å…ˆä»¤å…„å¼ŸèŠ‚ç‚¹ä¸ºçº¢è‰²ï¼Œå¦‚æœçˆ¶äº²æ˜¯çº¢è‰²ï¼Œåˆ™ç›´æ¥åˆ é™¤ xï¼Œå¹¶å°†çˆ¶äº²æ”¹ä¸ºé»‘è‰²ï¼Œå°±å®Œæˆäº†è°ƒæ•´ï¼›å¦‚æœçˆ¶äº²æ˜¯é»‘è‰²ï¼Œåˆ™æŠŠçˆ¶äº²å½“ä½œæ–°çš„è¢«åˆ é™¤èŠ‚ç‚¹è¿›è¡Œè°ƒæ•´ï¼ˆåªæ˜¯è°ƒæ•´æ–¹æ³•ï¼Œä¸ç”¨åˆ é™¤ï¼‰
        ![alt text](image-62.png)
    
    * case 3ï¼šè¢«åˆ é™¤èŠ‚ç‚¹çš„å…„å¼ŸèŠ‚ç‚¹æ˜¯é»‘è‰²çš„ï¼Œä¸”è¿‘ä¾„å­æ˜¯çº¢è‰²çš„â€”â€”å°†çº¢è‰²ç»™å…„å¼Ÿï¼Œå†æŠŠè¿‘ä¾„å­è½¬åˆ°å…„å¼Ÿçš„ä½ç½®ï¼ˆå˜æ¢æˆ case 4ï¼‰
        ![alt text](image-63.png) 
    * case 4ï¼šè¢«åˆ é™¤èŠ‚ç‚¹çš„å…„å¼ŸèŠ‚ç‚¹æ˜¯é»‘è‰²çš„ï¼Œä¸”è¿œä¾„å­æ˜¯çº¢è‰²çš„â€”â€”å…„å¼Ÿä¸çˆ¶äº²äº¤æ¢é¢œè‰²ï¼Œå†æŠŠå…„å¼Ÿè½¬ä¸Šæ¥ï¼Œåˆ é™¤ x
      
        ![alt text](image-64.png)

> å…·ä½“ä¾‹å­
>
> ![alt text](image-65.png)

## B+ Tree
------
### 1. å®šä¹‰

#### A B+ tree of order **M**:

* æ ¹èŠ‚ç‚¹è¦ä¹ˆæ²¡æœ‰å­©å­ï¼Œè¦ä¹ˆæœ‰$[2,M]$ä¸ªå­©å­

* é™¤æ ¹ä¹‹å¤–çš„éå¶å­èŠ‚ç‚¹ï¼Œæœ‰$[\lceil M/2\rceil,M]$ä¸ªå­©å­

<!-- å¥½åƒè¿˜æœ‰ä¸€ç‚¹ï¼Œyyæ€ä¹ˆä¸å‘pptğŸ˜­ -->

<!-- ä¸ºä»€ä¹ˆæ ¹èŠ‚ç‚¹ä¸åŒï¼Ÿ -->

------
### 2. æ’å…¥è¿‡ç¨‹

* æ’å…¥=>è‹¥è¶…é™=>åˆ†è£‚

* ä¿è¯æœ‰åº/æ‰¾åˆ°ä½ç½®ï¼šéå†ï¼ˆO(n)ï¼‰

* å¦‚æœæ¨åˆ°å‰é¢â€”â€”å¯èƒ½ O(n)ï¼Œå› æ­¤å®é™…æ“ä½œä¸è¿™ä¹ˆåš

<!-- ä¼ªä»£ç   -->
```c
Btree Insert(ElementType X,Btree T)
{
  Seach from root to leaf
}
```

<!-- æ—¶é—´å¤æ‚åº¦ -->

Find çš„æ—¶é—´å¤æ‚åº¦ï¼šO(logN)ï¼Œä¸ç®¡åº¦æ•°æ˜¯å¤šå°‘

> choose M: best 3 or 4

-------
> B+æ ‘çš„å¥½å¤„ï¼šç›¸è¿‘çš„å…ƒç´ ç¦»å¾—è¿‘ï¼Œç£ç›˜å‹å¥½

------
### 3. åˆ é™¤è¿‡ç¨‹


* åˆ é™¤èŠ‚ç‚¹=>è‹¥ä½äºæœ€ä½æ•°é‡é™åˆ¶åˆ™ï¼š
    
    * è‹¥å…„å¼Ÿæœ‰å¤šä½™èŠ‚ç‚¹ï¼Œåˆ™å€Ÿä¸€ä¸ªï¼Œæ›´æ–°é”®å€¼
    * è‹¥æ²¡æœ‰ï¼Œåˆ™ä¸å…„å¼Ÿåˆå¹¶ï¼Œå¹¶é€’å½’åœ°å‘ä¸Šæ“ä½œï¼Œè·Ÿæ–°é”®å€¼
